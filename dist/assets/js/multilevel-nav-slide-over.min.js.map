{"version":3,"sources":["multilevel-nav-slide-over.js"],"names":["$","fn","multilevelSlideOver","options","this","each","settings","$slideOverNav","mlnDataBreakpoint","attr","setDynamicHeight","find","css","parentCollapse","latestChildShowing","last","first","closest","dynamicHeight","outerHeight","extend","slideTitles","slideTitleLink","backButtonSymbol","dynamicBackButtonTitle","offCanvasCloseAllMenus","$navEl","currentMenuId","nextCollapseHelper","menuSectionLink","menuSectionLabel","html","backButtonText","text","addClass","prependTo","appendTo","clone","removeClass","removeAttr","remove","end","on","trigger","hasClass","mlnViewport","width","undefined","el","lastIsMln","tabbable","firstTabbable","lastTabbable","latestNavShowing","focus","e","which","shiftKey","preventDefault","window","one","document","is","min-height","jQuery"],"mappings":"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","sourcesContent":["/*!\n  * Multilevel nav slide over functionality v1\n  */\n  \n(function ($) {\n    'use strict';\n\n    // Slide over keyboard trap\n    var slideOverKeyboardTrap = function(el) {\n\n        // Tabbable elements\n        var lastIsMln = el.find('.mln__child__list')\n            .first()\n            .find(' > .mln__has-child:last-child > .mln__child-controls')\n            .first()\n            .find('> .mln__toggle-btn, > .mln__toggle-link');\n        \n        var tabbable = el.find(\n            'a[href],' +\n            'area[href],' +\n            'input:not([disabled]),' +\n            'select:not([disabled]),' +\n            'textarea:not([disabled]),' +\n            'button:not([disabled]),' +\n            'iframe,' +\n            'object,' +\n            'embed,' +\n            '[tabindex=\"0\"],' +\n            '[contenteditable]'\n        );\n\n        var firstTabbable = tabbable.first();\n        var lastTabbable = (lastIsMln.length) ? lastIsMln  : tabbable.last();\n        \n        // Set focus on first input\n        firstTabbable.focus();\n\n        // Redirect last tab to first input\n        lastTabbable.on('keydown', function(e) {\n            if (e.which === 9 && !e.shiftKey && $('body').hasClass('js-off-canvas-showing')) {\n                e.preventDefault();\n                firstTabbable.focus();\n            }\n        });\n\n        // Redirect first shift+tab to last input\n        firstTabbable.on('keydown', function(e) {\n            if (e.which === 9 && e.shiftKey && $('body').hasClass('js-off-canvas-showing')) {\n                e.preventDefault();\n                lastTabbable.focus();\n            }\n        });\n    };\n          \n    $.fn.multilevelSlideOver = function (options) {\n        $(this).each(function () {\n            var $slideOverNav = $(this);\n            var settings;\n            var mlnDataBreakpoint = $slideOverNav.attr('data-mln-breakpoint');\n            \n            // Setting defaults\n            settings = $.extend({\n                'slideTitles': true,\n                'slideTitleLink': false,\n                'backButtonSymbol': '&lsaquo;',\n                'dynamicBackButtonTitle': false,\n                'offCanvasCloseAllMenus': false\n            }, options);\n                        \n            function closeAllChildren() {\n                if ($slideOverNav.is('.mln--navbar-slide-over')) {\n                    $slideOverNav\n                        .find('[aria-hidden=\"false\"]')\n                        .attr('aria-hidden', true)\n                        .removeClass('mln--height-auto mln__child--overflow-visible')\n                        .end()\n                        .find('.mln__visible-menu')\n                        .removeClass('mln__visible-menu')\n                        .end()\n                        .find('.mln__list')\n                        .addClass('mln__visible-menu')   \n                        .end()\n                        .find('[aria-expanded=\"true\"]')\n                        .attr('aria-expanded', false)\n                        .closest('.mln__has-child--showing')\n                        .removeClass('mln__has-child--showing')\n                        .closest('.mln--navbar-slide-over')\n                        .css({\n                            'min-height': ''\n                        });      \n                }\n            }\n            \n            // Set height on certain elements to make the outer nav height the same\n            // height as the current viewable slide\n            function setDynamicHeight() {\n\n                // Reset inline css\n                $slideOverNav.find('.mln__child__collapse').css('min-height', '');\n\n                if (parentCollapse) {\n                    parentCollapse.css('min-height', '');\n                }\n\n                // Cache correct elements and get their proper height\n                var latestChildShowing = $slideOverNav.find('.mln__has-child.mln__has-child--showing')\n                    .last()\n                    .find(' > .mln__child__collapse')\n                    .first()\n                    .find('> .mln__child__collapse__helper');\n                \n                var parentCollapse = $slideOverNav.find('.mln__has-child.mln__has-child--showing')\n                    .last()\n                    .closest('.mln__child__collapse');\n                \n                var getHeightFromThis = (latestChildShowing.length) ? latestChildShowing : $slideOverNav.find('.mln__list');\n                \n                // Correct height wether it's a child or the top level list\n                var dynamicHeight = getHeightFromThis.outerHeight();\n                \n                // Set nav elements height to the same as the current viewable slide\n                $slideOverNav.css('min-height', dynamicHeight);\n\n                // Set the height of the current slides parent collapse\n                // to prevent clunky inner scrollbars\n                parentCollapse.css('min-height', dynamicHeight);\n            }\n            \n            // Help mln act like overlay nav for mobile devices\n            $slideOverNav.find('.mln__has-child').each(function() {\n                var $navEl = $(this);\n                var currentMenuId = $navEl.find('.mln__child__collapse').first().attr('id');\n                var nextCollapseHelper = $navEl.find('.mln__child__collapse__helper').first();\n                var menuSectionLink = $navEl.find(' > .mln__child-controls > a');\n                var menuSectionLabel = menuSectionLink.html();\n                var backButtonSymbol = (settings.backButtonSymbol) ? '<span aria-hidden=\"true\">' + settings.backButtonSymbol + '</span> ' : '';\n                var backButtonText = (menuSectionLink.attr('data-mln-not-linkable') || settings.dynamicBackButtonTitle) ? backButtonSymbol + menuSectionLink.text() : backButtonSymbol + 'Back';\n\n                $('<div>')\n                    .addClass('mln__slide-over-controls')\n                    .prependTo(nextCollapseHelper);\n                    \n                $('<button>')\n                    .addClass('mln__back-btn')\n                    .attr('type', 'button')\n                    .attr('aria-controls', currentMenuId)\n                    .html(backButtonText)\n                    .prependTo($navEl.find('.mln__slide-over-controls'));\n                    \n                // Build slide title no link\n                if (settings.slideTitles && !settings.slideTitleLink) {\n                    $('<span>')\n                        .addClass('mln__slide-over-title')\n                        .html(menuSectionLabel)\n                        .appendTo($navEl.find('.mln__slide-over-controls'));\n                }\n                \n                // Build slide title with link\n                if (settings.slideTitles && settings.slideTitleLink) {\n                    menuSectionLink\n                        .clone()\n                        .addClass('mln__slide-over-title')\n                        .removeClass('mln__toggle-link')\n                        .removeAttr('role aria-expanded aria-controls')\n                        .find('.mln__toggle-indicator')\n                        .remove()\n                        .end()\n                        .appendTo($navEl.find('.mln__slide-over-controls'));\n                }\n\n                $navEl\n                    .find('.mln__back-btn')\n                    .first()\n                    .on('click', function(){\n                        $navEl\n                            .find('.mln__toggle-btn[aria-controls=\"' + currentMenuId + '\"], .mln__toggle-link[aria-controls=\"' + currentMenuId + '\"]')\n                            .trigger('click');\n                    });\n            });\n            \n            // Set dynamic height when mln events fire\n            $slideOverNav.on('show.mln.child', function() {\n                if ($slideOverNav.hasClass('mln--navbar-slide-over') && mlnViewport().width < mlnDataBreakpoint || mlnDataBreakpoint === undefined) {\n                    setDynamicHeight($slideOverNav);\n                }\n            }).on('hide.mln.child', function() {\n                if ($slideOverNav.hasClass('mln--navbar-slide-over') && mlnViewport().width < mlnDataBreakpoint || mlnDataBreakpoint === undefined) {\n                    setDynamicHeight($slideOverNav);\n                }\n            }).on('shown.mln.child', function(){\n                var latestNavShowing = $slideOverNav.find('.mln__has-child--showing')\n                    .last()\n                    .addClass('mln__has-child--active')\n                    .find('.mln__child__collapse')\n                    .first();\n                \n                slideOverKeyboardTrap(latestNavShowing);\n            });  \n            \n            // Remove dynamic height on navbar after resize\n            $(window).on('mlnResizeEnd', function () {\n                if ($slideOverNav.hasClass('mln--navbar-slide-over') && mlnViewport().width > mlnDataBreakpoint) {\n                    $slideOverNav.css('min-height', '');\n                } else {\n                    setDynamicHeight($slideOverNav);\n                }\n            });\n                                    \n            // Close all menus when closing off canvas\n            if (settings.offCanvasCloseAllMenus) {\n                $('.toggle-off-canvas').one('click', function() {\n                    var $toggleButton = $(this);\n                                    \n                    if ($toggleButton.attr('aria-expanded') === 'true') {\n                        $(document).on('hidden.offCanvas', function() {\n                            closeAllChildren();\n                        });\n                    }\n                });    \n            }\n            \n            setDynamicHeight($(this));\n        });\n    };\n}(jQuery));\n"]}